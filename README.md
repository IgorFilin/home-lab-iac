Структура системы на базе Proxmox :

*LXC : `ansible-control*
_Основной управляющий контейнер для автоматизации и средство выполнения для работы с инфраструктурой (раннер)._
-   Установлен **Ansible** — для управления всеми сервисами.
-   Цель: выполнение плейбуков, автоматизация системы, в CICD по триггеру защищённой ветки main, при изменении нужной директории.

*LXC : `k3s`*
_Основной кластер Kubernetes_
-   Работает **k3s** — легковесный Kubernetes.
-   Запущенные микросервисы:
    -   **Backend-сервисы** (на Go / Nest.js) — API, логика приложений.
    -   **Frontend-приложения** — Angular SPA.
    -   **External Secrets Operator (ESO)** — для подтягивания секретов из Vault.

*LXC : `vault`*
_Сервер для безопасного хранения и управления секретами._
- Интегрирован с Kubernetes через **Kubernetes Auth Method**.
- Секреты используются в k3s через **External Secrets Operator (ESO)**.
- Никакие секреты **не хранятся в Git** — только через Vault.
- Автоматическое, идемпотентное развёртывание через **Ansible**

*VM : `monitoring`*
_Сервер для централированного мониторинга системы._
- Prometheus (метрики), Loki (логи), Grafana (визуализация).
- Сбор метрик с хостов и сервисов через node_exporter, nginx_exporter
- Автоматическое, идемпотентное развёртывание через **Ansible**

*LXC 100: `reverse-proxy`*
 _Обратный прокси и шлюз для внешнего доступа._
-   Установлен **Nginx**.
-   Настроена маршрутизация по поддоменам:
    -   `nextcloud.your-domain.com`
    -   `mail.your-domain.com`
-   Включено **TLS (Let’s Encrypt)** — HTTPS для входящего трафика, и проксирование по http внутри своей сети.

*LXC 104: `mailcow`*
_Почтовый сервер с полным набором функций._
-   Полностью настроен с:
    -   **SPF**, **DKIM**, **DMARC** записи для корректно верификации почты и тд.
    -   Веб-интерфейс для управления почтой.

*LXC 103: `postgresql`*
_База данных для приложений._
-   Используется как хранилище для веб приложений

*LXC 105: `rabbitMQ`*
_Брокер сообщений для асинхронных задач._
-   Используется для очередей задач между микросервисами.

*LXC 102: `nextcloud`*
_Облачное хранилище и офисный пакет._
Полностью настроен с синхронизацией файлов, календарём, контактами.

*LXC 107: `git-lab-docker-runner`*
_GitLab Runner для CI/CD пайплайнов._
-   Использует **Docker executor** — запускает jobs в контейнерах.
-   Интегрирован с моими GitLab-проектами.

*LXC 101: `microServices`*
_Контейнер для общих микросервисов или демонов._
-   Содержит микросервис чата на Go
